# Подсолнух
Приложение для Android позволяющее автоматически устанавливать яркость экрана по позиции солнца.

Проект разработан для планшета установленного в качестве CarPC.

<img src="https://cloud.githubusercontent.com/assets/3936845/23095717/c9215c38-f638-11e6-9790-701ecdb7bc8f.png">
<img src="https://cloud.githubusercontent.com/assets/3936845/23095716/c92102c4-f638-11e6-8420-e89831452755.png">
<img src="https://cloud.githubusercontent.com/assets/3936845/23095715/c920cc28-f638-11e6-8bdb-624bf4ff9dc2.png">

### Требования
* Android 4.0.3 и выше

### Алгоритм работы
При разблокировке экрана (`ACTION_USER_PRESENT`) проверяется текущее время и устанавливается один из трёх режимов: день, сумерки, ночь. Для каждого из режимов в настройках можно установить желаемый уровень яркости экрана.

При включенной опции **`Изменять яркость при включенном экране`** запускается фоновый сервис, который через заданный интервал (**`Частота проверки яркости экрана`**) будет проверять время и актуальность яркости экрана.

При блокировке экрана (`ACTION_SCREEN_OFF`) фоновый сервис завершит работу.

### Android >= 6.x
Начиная с версии Android Marshmallow, при запуске будет запущено окно настроек `Settings.ACTION_MANAGE_WRITE_SETTINGS`, где необходимо разрешить программе изменение системных настроек. Программа изменяет только один пункт - отключает автоматическую (адаптивную) настройку яркости экрана.
<img src="https://cloud.githubusercontent.com/assets/3936845/11914352/c625fe70-a6a8-11e5-831a-4614c03f077d.png" width="480">

### GPS время
Включив в настройках опцию `Обновлять время по GPS` программа при запуске будет ожидать NMEA данные от GPS приёмника. Получив $GPRMC строку, с помощью команды `date -u ...` будет установлена системная дата. Для команды `date -u ...`
необходимы root-права.
